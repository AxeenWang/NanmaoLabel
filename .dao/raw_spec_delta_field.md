# 南茂標籤列印 POC 需求調整規格書

| 項目 | 內容 |
|------|------|
| 文件版本 | v1.2 |
| 基準文件 | raw_spec.md v2.5 |
| 建立日期 | 2026-01-28 |
| 狀態 | **草稿** |

---

## 文件說明

本文件記錄對「南茂標籤列印 POC 需求規格書 v2.5」的變更與新增需求。所有變更皆以「差異」方式呈現，不破壞原 spec 結構。

**變更類型定義：**

| 類型 | 說明 |
|------|------|
| 修改 | 調整原 spec 既有內容 |
| 新增 | 新增原 spec 未定義的需求 |
| 刪除 | 移除原 spec 既有內容 |
| 釐清 | 針對原 spec 模糊或矛盾處進行釐清 |

---

## 變更清單總覽

| 編號 | 類型 | 對應章節 | 摘要 | 狀態 |
|------|------|----------|------|------|
| CR-01 | 釐清 | 13.11 | Excel 欄位名稱允許底線 | 待確認 |
| CR-02 | 修改 | 8.7 | Kiosk UI 規範強化（深色主題、按鈕尺寸、配色） | 待確認 |
| CR-03 | 新增 | 8.7 | DataGrid 與編輯區規範 | 待確認 |

---

## 變更明細

### CR-01：Excel 欄位名稱允許底線

| 項目 | 內容 |
|------|------|
| 變更編號 | CR-01 |
| 變更類型 | 釐清 |
| 對應章節 | 13.11 Excel 欄位名稱限制 |
| 優先順序 | 高 |
| 狀態 | 待確認 |

**問題描述：**

原 spec 存在自相矛盾：

| 位置 | 規定 | 結果 |
|------|------|------|
| 附錄 A | 定義 `nvr_cust`、`nvr_cust_item_no`、`nvr_cust_pn`、`nvr_remark10` 等欄位 | 欄位名稱**包含底線** |
| 13.11 節 | 「Excel 欄位名稱僅允許英數，底線/空白/特殊符號不容錯」 | **禁止底線** |

導致實作時，附錄 A 定義的關鍵欄位（客戶名稱、客戶料號、客戶 P/N、備註）被忽略。

**原文內容（13.11 節）：**

> Excel 欄位名稱僅允許英數，底線/空白/特殊符號不容錯

**修改後內容：**

> Excel 欄位名稱僅允許**英數字及底線（`_`）**，空白及其他特殊符號不容錯

**變更理由：**

1. 與附錄 A 定義的欄位名稱相容
2. 符合一般程式變數命名慣例（snake_case）
3. 仍維持對空白及特殊符號的禁止，確保資料品質

**影響範圍：**

| 項目 | 影響 |
|------|------|
| Excel 匯入模組 | 需調整欄位名稱驗證邏輯，允許底線 |
| 錯誤訊息 | 需更新提示文字 |
| 現有資料 | 無影響（修正後可正常匯入） |

---

### CR-02：Kiosk UI 規範強化

| 項目 | 內容 |
|------|------|
| 變更編號 | CR-02 |
| 變更類型 | 修改 |
| 對應章節 | 8.7 UI 細節規範 |
| 優先順序 | 高 |
| 狀態 | 待確認 |

**問題描述：**

目前實作的介面未符合 Kiosk 標準：

| 問題 | 現況 |
|------|------|
| 按鈕尺寸 | 過小，不符合觸控友善標準 |
| 配色 | 接近純白底色，視覺層次不明確，缺乏 Kiosk 風格 |
| 字體 | 按鈕文字偏小 |
| 圖示 | 缺乏圖示輔助，操作不夠直覺 |

**修改內容：**

#### 1. 整體配色方案（深色工業風 Kiosk）

| 元素 | 色碼 | 說明 |
|------|------|------|
| 背景色（主區域） | `#1A1D23` | 深色炭灰，降低視覺疲勞 |
| 背景色（卡片/面板） | `#252A33` | 略淺的深灰，區分層次 |
| 主要動作按鈕 | `#3B82F6` | 亮藍色（匯入、輸出 PDF） |
| 成功/確認按鈕 | `#22C55E` | 綠色（儲存、確認） |
| 危險/刪除按鈕 | `#EF4444` | 紅色（刪除） |
| 次要動作按鈕 | `#6B7280` | 中灰（取消、返回） |
| 新增按鈕 | `#8B5CF6` | 紫色（新增資料） |
| 文字色（主要） | `#F9FAFB` | 近白色 |
| 文字色（次要） | `#9CA3AF` | 淺灰 |
| 邊框/分隔線 | `#374151` | 深灰邊框 |
| 選取列 Highlight | `#3B82F6` + 20% 透明 | 藍色半透明 |

#### 2. 按鈕規格

| 項目 | 規格 |
|------|------|
| 最小高度 | **64px** |
| 最小寬度 | 120px（依內容自適應） |
| 圓角 | 8px |
| 內距 | 水平 24px，垂直 16px |
| 按鈕間距 | 最小 16px |

#### 3. 按鈕字體規格

| 項目 | 規格 |
|------|------|
| 字體大小 | **18pt**（原 9pt 的兩倍） |
| 字重 | Semi-Bold (600) |
| 字色 | `#F9FAFB`（近白色） |

#### 4. 按鈕圖示規範

所有操作按鈕必須包含「圖示 + 文字」組合：

| 按鈕 | 圖示 | 文字 |
|------|------|------|
| 匯入 | 📂 或 Upload 圖示 | 匯入 |
| 新增 | ➕ 或 Plus 圖示 | 新增 |
| 刪除 | 🗑️ 或 Trash 圖示 | 刪除 |
| 儲存 | 💾 或 Save 圖示 | 儲存 |
| 輸出 PDF | 📄 或 Document 圖示 | 輸出 PDF |
| 批次輸出 | 📑 或 Documents 圖示 | 批次輸出 |

圖示規格：
- 尺寸：24x24px
- 位置：文字左側，間距 8px
- 風格：線條圖示（Outlined），與深色主題協調

#### 5. 標題列配色調整

| 元素 | 色碼 |
|------|------|
| 標題列背景 | `#0F172A`（深藍黑） |
| 標題文字 | `#F9FAFB` |

#### 6. 分頁指示器

| 元素 | 規格 |
|------|------|
| 選中分頁底線 | `#3B82F6`，厚度 3px |
| 未選中分頁文字 | `#9CA3AF` |
| 選中分頁文字 | `#F9FAFB` |

#### 7. 空白狀態 UI

| 元素 | 規格 |
|------|------|
| 圖示尺寸 | 64x64px |
| 圖示顏色 | `#6B7280` |
| 提示文字 | 18pt，`#9CA3AF` |

**變更理由：**

1. 深色主題減少長時間使用的視覺疲勞
2. 64px 按鈕高度符合工業觸控螢幕操作標準
3. 圖示 + 文字組合提升操作直覺性
4. 明確的色彩語義（藍=主要、綠=確認、紅=危險）降低誤操作

**影響範圍：**

| 項目 | 影響 |
|------|------|
| 全域樣式 | 需重構 App.xaml 中的 ResourceDictionary |
| 所有按鈕 | 需套用新樣式與圖示 |
| 背景與面板 | 需調整為深色主題 |
| DataGrid | 需調整列樣式與選取樣式 |

---

### CR-03：DataGrid 與編輯區規範

| 項目 | 內容 |
|------|------|
| 變更編號 | CR-03 |
| 變更類型 | 新增 |
| 對應章節 | 8.7 UI 細節規範 |
| 優先順序 | 高 |
| 狀態 | 待確認 |

**問題描述：**

目前 DataGrid 與編輯區存在多項問題：

| 問題 | 現況 |
|------|------|
| 選取列樣式異常 | Highlight 延伸超出 DataGrid 欄位範圍，右側變成純藍色長條 |
| 列高偏小 | 不符合 Kiosk 觸控標準 |
| 欄位截斷 | 裝置編號等長欄位顯示不完整，無法查看全文 |
| 編輯區輸入框 | 白色底與深色主題不協調 |

**修改內容：**

#### 1. DataGrid 列規格

| 項目 | 規格 | 理由 |
|------|------|------|
| 列高 | **56px** | 觸控友善，手指點擊不易誤觸 |
| 列間距 | 1px 分隔線 `#374151` | 視覺區隔但不過重 |
| 斑馬紋 | 奇數列 `#252A33`，偶數列 `#1E2330` | 長表格易於追蹤橫向資訊 |
| 字體大小 | **14pt** | 適合 Kiosk 閱讀距離 |

#### 2. 選取列樣式修正

| 項目 | 規格 |
|------|------|
| 背景色 | `#3B82F6`（主藍）+ 30% 透明度 |
| 左側指示條 | 4px 寬，`#3B82F6` 實色 |
| 範圍限制 | **僅覆蓋 DataGrid 欄位範圍，禁止外溢** |
| 文字色 | 選取時維持 `#F9FAFB`，不變色 |

#### 3. 欄寬處理策略

| 策略 | 說明 |
|------|------|
| 固定欄 | 單據編號、日期、數量 — 固定寬度 |
| 彈性欄 | 客戶名稱、裝置編號 — 按比例分配剩餘空間 |
| 最小寬度 | 每欄最小 80px，避免過度壓縮 |
| 溢出處理 | Ellipsis 截斷 + **Tooltip 顯示完整內容** |
| 欄位可調整 | 允許用戶拖曳調整欄寬 |

#### 4. 編輯區輸入框（深色主題）

| 元素 | 色碼 | 說明 |
|------|------|------|
| 輸入框背景 | `#374151` | 深灰，與面板區分 |
| 輸入框邊框（預設） | `#4B5563` | 中灰邊框 |
| 輸入框邊框（Focus） | `#3B82F6` | 藍色聚焦提示 |
| 輸入框文字 | `#F9FAFB` | 近白色 |
| 輸入框高度 | **48px** | 觸控友善 |
| 欄位標籤 | `#9CA3AF`，**12pt** | 次要色，清晰可讀 |
| 標籤與輸入框間距 | 8px | 視覺呼吸空間 |

#### 5. 編輯區佈局優化

| 項目 | 規格 |
|------|------|
| 區域背景 | `#1A1D23`（主背景）或 `#252A33`（卡片式） |
| 欄位排列 | 兩欄式，左右對稱 |
| 欄位間距 | 水平 32px，垂直 16px |
| 分隔線 | DataGrid 與編輯區之間加 1px `#374151` 分隔 |
| 空狀態 | 未選取時顯示提示「請選取資料列進行編輯」 |

#### 6. 表頭規格

| 項目 | 規格 |
|------|------|
| 背景色 | `#1E293B` |
| 文字色 | `#9CA3AF` |
| 字體 | **12pt Semi-Bold** |
| 高度 | 48px |
| 分隔線 | 底部 2px `#374151` |

**變更理由：**

1. 修正選取列 Highlight 外溢的視覺異常
2. 56px 列高符合工業觸控標準
3. Tooltip 解決長欄位截斷問題，保持介面整潔
4. 編輯區深色主題與整體 UI 一致
5. 斑馬紋與左側指示條提升資料追蹤效率

**影響範圍：**

| 項目 | 影響 |
|------|------|
| DataGrid 樣式 | 需重寫 DataGridRow、DataGridCell 樣式 |
| 選取樣式 | 需修正 SelectedItem 觸發的樣式範圍 |
| 編輯區 | 需調整 TextBox 樣式與佈局 |
| Tooltip | 需為長欄位加入 Tooltip 綁定 |

---

## 變更紀錄

| 版本 | 日期 | 變更內容 | 作者 |
|------|------|----------|------|
| v1.0 | 2026-01-28 | 初版建立，新增 CR-01 | Swang |
| v1.1 | 2026-01-28 | 新增 CR-02 Kiosk UI 規範強化 | Swang |
| v1.2 | 2026-01-28 | 新增 CR-03 DataGrid 與編輯區規範 | Swang |
