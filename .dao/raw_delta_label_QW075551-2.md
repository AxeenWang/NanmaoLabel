# 物料標籤 QW075551-2 — CodeSoft 欄位對照修正規格

| 項目       | 內容                                        |
|------------|---------------------------------------------|
| 文件類型   | Delta Spec（標籤修正規格）                   |
| 對應標籤   | QW075551-2（物料標籤）                       |
| 基準文件   | raw_spec.md v2.5（§5.2 QW075551-2 欄位對應）|
| 建立日期   | 2026-02-02                                  |
| 狀態       | **定案**                                    |

---

## 1. 修正範圍說明

本文件針對 QW075551-2 物料標籤的 **CodeSoft 欄位對照設定** 與 **版面配置** 進行重新定義，取代 raw_spec.md §5.2「欄位對應」表格中的對應邏輯。

本次修正 **涉及** 以下項目：

- 標籤標題：由「出貨標籤 Shipping Label」**變更為「物料標籤」**（見 §5）
- 版面配置：由原規格上下分區式 **變更為左右兩欄式佈局**（見 §4）
- ERPPARTNO 類型：由 Barcode **變更為 Text**（見 §2.2）
- QR Code：**移除**（見 §3）
- 欄位前綴標籤：依圖片重新定義（見 §5.2）

本次修正 **不涉及** 以下項目（維持原規格不變）：

- 字型規格（raw_spec.md §5.3）
- 資料處理規範（數量千分位顯示、Trim 空白等）
- PDF 輸出與驗收規範（第 13 章）

### 1.1 長文字溢出處理策略

| 項目 | 規則 |
|------|------|
| 處理方式 | **不可截斷**，採用**縮小字體**方式處理 |
| 適用範圍 | 所有 Text 欄位 |
| 實作位置 | LabelRenderer |

### 1.2 QW075551-1 影響聲明

本 Delta Spec **僅針對 QW075551-2**，QW075551-1 已於 `raw_delta_label_QW075551-1.md` 另行修正。

---

## 2. CodeSoft 欄位對照定義（唯一正確來源）

以下表格為 QW075551-2 所有 CodeSoft 變數欄位的完整定義，**取代** raw_spec.md §5.2 Item 1–7 的欄位對應。

> 📌 程式碼實作時使用「資料來源欄位」名稱（如 `cscustpo`），CodeSoft 欄位名僅供規格對照使用。

| Item | CodeSoft 欄位    | 資料來源欄位      | 資料來源說明 | 顯示類型 |
|------|------------------|-------------------|-------------|----------|
| 1    | CSCUSTPO         | cscustpo          | 單號        | Text     |
| 2    | CSNUMBER         | "17008"           | 代碼（固定值）| Text   |
| 3    | ERPPARTNO        | erpmat            | ERP 料號    | Text     |
| 4    | CSCUSTITEMNO     | nvr_cust_item_no  | 規格型號    | Text     |
| 5    | CSQTY            | ogd09             | 數量        | Text     |
| 6    | CSREMARK         | nvr_remark10      | D/C (LOT NO.)| Text    |

### 2.1 與原規格差異說明

| 項目                        | 原規格（raw_spec.md §5.2）        | 本次修正                          | 變更性質         |
|-----------------------------|-----------------------------------|-----------------------------------|------------------|
| Item 1 CSCUSTPO             | 同左                              | 無變更（重新確認）                | 確認，無異動     |
| Item 2 CSNUMBER             | "17008"（固定值）                 | 無變更（重新確認）                | 確認，無異動     |
| Item 3 ERPPARTNO 顯示類型   | **Barcode**（Code 128）           | **Text**                          | **變更**         |
| Item 4 CSCUSTITEMNO         | 同左                              | 無變更（重新確認）                | 確認，無異動     |
| Item 5 CSQTY                | 同左                              | 無變更（重新確認）                | 確認，無異動     |
| Item 6 CSREMARK             | 同左                              | 無變更（重新確認）                | 確認，無異動     |
| Item 7 QRCODE               | `{cscustpo};{erpmat};{ogd09}`     | **移除**                          | **變更**         |

> ⚠️ **Code 128 與 QR Code 移除聲明**：本標籤移除所有條碼類型（Code 128 與 QR Code），僅保留純文字欄位。

### 2.2 Item 3 變更詳述

| 項目     | 說明                                                                                     |
|----------|------------------------------------------------------------------------------------------|
| 欄位     | ERPPARTNO                                                                                |
| 原定義   | Type = Barcode（Code 128），版面座標 X=5, Y=29, 寬=60mm, 高=10mm                        |
| 修正後   | Type = **Text**，依圖片版面呈現為純文字行                                                |
| 修正依據 | 物料標籤格式圖與預覽圖均顯示 ERPPARTNO 為純文字（範例值 `4D010018`），無條碼渲染        |
| 影響     | 原 Barcode 座標不再適用，需依版面重新配置為 Text 座標                                   |

---

## 3. QR Code 規格定義

### 3.1 QR Code 移除聲明

| 項目         | 定義                                                |
|--------------|-----------------------------------------------------|
| 原規格       | QRCODE = `{cscustpo};{erpmat};{ogd09}`             |
| 本次修正     | **移除**                                            |
| 修正依據     | 物料標籤格式圖與預覽圖均無 QR Code                  |

> 📌 QW075551-2 物料標籤不包含任何條碼或 QR Code，所有資訊以純文字方式呈現。

---

## 4. 版面配置參考說明

本次修正以「物料標籤格式_QW075551-2.png」與「物料標籤預覽_QW075551-2.png」作為版面參考，以下為圖片所示版面與原規格（raw_spec.md §5.2 座標表）的差異觀察：

### 4.1 版面差異觀察

| 區域             | 原規格版面（raw_spec.md §5.2）                     | 圖片版面                                          | 差異類型       |
|------------------|---------------------------------------------------|---------------------------------------------------|----------------|
| 整體佈局         | 上下分區式，依序排列                               | **左右兩欄式佈局**                                 | **版面結構變更** |
| 標題             | 出貨標籤 Shipping Label                            | **物料標籤**                                       | **標題變更**    |
| ERPPARTNO 呈現   | Barcode（Code 128），獨立條碼區域                  | 純文字，位於左欄                                   | **類型變更**（已於 §2.2 定義） |
| QR Code          | 有（右下角）                                       | **無**                                             | **移除**        |
| 欄位前綴標籤     | Customer PO: / CS Number: / ERP Part NO. 等       | 單號: / 代碼: / ERP料號: / 規格型號: / 數量: / D/C (LOT NO. ): | **標籤變更** |

### 4.2 本次修正範圍界定

| 差異項目                           | 是否納入本次修正 | 說明                                                         |
|------------------------------------|------------------|--------------------------------------------------------------|
| 標題由「出貨標籤」→「物料標籤」     | ✅ 已納入        | 見 §5.1                                                     |
| 版面由上下式 → 左右兩欄式          | ✅ 已納入        | 見 §4.3                                                     |
| ERPPARTNO 類型由 Barcode → Text    | ✅ 已納入        | 見 §2.2                                                     |
| QR Code 移除                       | ✅ 已納入        | 見 §3                                                       |
| 欄位前綴標籤重新定義               | ✅ 已納入        | 見 §5.2                                                     |
| 版面座標全面重新定義               | ✅ 已納入        | **本次實作以圖片版面為準**，取代原規格座標表                 |

> 📌 本次實作以「物料標籤格式_QW075551-2.png」與「物料標籤預覽_QW075551-2.png」為唯一版面權威來源，原 raw_spec.md §5.2 座標表不再適用。

### 4.3 座標配置授權

| 項目 | 說明 |
|------|------|
| 授權方式 | 開發者依圖片自行配置各欄位 X/Y/Width/Height |
| 驗收標準 | **以 PDF 輸出為唯一驗收依據**，版面視覺呈現符合圖片即可 |
| 調整彈性 | 允許微調間距、對齊，不需完全吻合圖片像素 |

### 4.4 版面配置規則（以圖片為準）

版面採用 **左右兩欄式佈局**，每個欄位為 **雙行顯示**：
- **第一行（小字）**：「標籤:實際值」格式
- **第二行（大字 Bold）**：純實際值（強調用）

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              物料標籤                                            │
│                                                                                 │
│ 單號:P600-X172509050001                    代碼:17008                            │ ← 小字
│ P600-X172509050001                         17008                                 │ ← 大字 Bold
│                                                                                 │
│ ERP料號:4D010018                           規格型號:XPA72EA0I-008                │ ← 小字
│ 4D010018                                   XPA72EA0I-008                         │ ← 大字 Bold
│                                                                                 │
│ 數量:6,733                                 D/C (LOT NO. ):00U35NVVR              │ ← 小字
│ 6,733                                      00U35NVVR                             │ ← 大字 Bold
└─────────────────────────────────────────────────────────────────────────────────┘
```

> 📌 每個欄位顯示兩次：第一行帶標籤（小字），第二行純數值（大字 Bold 強調）。

### 4.5 欄位配置表（參考值）

標籤尺寸：**100mm × 60mm**（維持原規格）

| 區域 | 元素 | X (mm) | Y (mm) | Width (mm) | Height (mm) | 字型大小 | 說明 |
|------|------|--------|--------|------------|-------------|----------|------|
| 標題 | "物料標籤" | 5 | 3 | 90 | 6 | 14pt Bold | 置中 |
| 第一列 | "單號:" + CSCUSTPO | 5 | 12 | 45 | 4 | 8pt | 小字，靠左 |
| 第一列 | CSCUSTPO | 5 | 17 | 45 | 6 | 11pt Bold | 大字，靠左 |
| 第一列 | "代碼:" + CSNUMBER | 55 | 12 | 40 | 4 | 8pt | 小字，靠左 |
| 第一列 | CSNUMBER | 55 | 17 | 40 | 6 | 11pt Bold | 大字，靠左 |
| 第二列 | "ERP料號:" + ERPPARTNO | 5 | 26 | 45 | 4 | 8pt | 小字，靠左 |
| 第二列 | ERPPARTNO | 5 | 31 | 45 | 6 | 11pt Bold | 大字，靠左 |
| 第二列 | "規格型號:" + CSCUSTITEMNO | 55 | 26 | 40 | 4 | 8pt | 小字，靠左 |
| 第二列 | CSCUSTITEMNO | 55 | 31 | 40 | 6 | 11pt Bold | 大字，靠左 |
| 第三列 | "數量:" + CSQTY | 5 | 40 | 45 | 4 | 8pt | 小字，靠左 |
| 第三列 | CSQTY | 5 | 45 | 45 | 6 | 11pt Bold | 大字，靠左 |
| 第三列 | "D/C (LOT NO. ):" + CSREMARK | 55 | 40 | 40 | 4 | 8pt | 小字，靠左 |
| 第三列 | CSREMARK | 55 | 45 | 40 | 6 | 11pt Bold | 大字，靠左 |

#### 配置說明

| 項目 | 數值 | 說明 |
|------|------|------|
| 左欄起始 X | 5mm | 標籤左邊界 |
| 右欄起始 X | 55mm | 標籤中間位置 |
| 列間距 | 約 14mm | 每列（小字行+大字行）的高度 |
| 小字行與大字行間距 | 5mm | 標籤行與數值行的垂直間距 |
| 小字字型 | 8pt | 「標籤:實際值」格式 |
| 大字字型 | 11pt Bold | 純實際值，強調用 |

> 📌 以上座標為參考值，開發者可依實際渲染效果微調，以 PDF 輸出視覺呈現為驗收標準。

---

## 5. 固定元素與版面設計

### 5.1 標題變更

| 項目     | 原規格（raw_spec.md §5.2）      | 本次修正       |
|----------|--------------------------------|----------------|
| 標題文字 | 出貨標籤 Shipping Label        | **物料標籤**   |
| 字型樣式 | 14pt Bold，置中                | 14pt Bold，置中（維持） |

### 5.2 欄位前綴標籤對照

每個欄位採用 **雙行顯示**：
- **小字行**：「標籤:實際值」格式
- **大字行**：純實際值（Bold 強調）

| CodeSoft 欄位 | 原規格前綴標籤          | 本次修正前綴標籤    | 小字行範例 | 大字行範例 |
|---------------|------------------------|---------------------|-----------|-----------|
| CSCUSTPO      | Customer PO:           | **單號:**           | 單號:P600-X172509050001 | P600-X172509050001 |
| CSNUMBER      | CS Number:             | **代碼:**           | 代碼:17008 | 17008 |
| ERPPARTNO     | ERP Part NO.           | **ERP料號:**        | ERP料號:4D010018 | 4D010018 |
| CSCUSTITEMNO  | Customer Item:         | **規格型號:**       | 規格型號:XPA72EA0I-008 | XPA72EA0I-008 |
| CSQTY         | Q'ty                   | **數量:**           | 數量:6,733 | 6,733 |
| CSREMARK      | Remark:                | **D/C (LOT NO. ):** | D/C (LOT NO. ):00U35NVVR | 00U35NVVR |

### 5.3 標籤邊框

| 項目 | 規格 |
|------|------|
| 外框 | **需要繪製**，單線矩形邊框 |
| 分隔線 | **不需要**（圖片所示分隔線僅供參考，實作時不繪製） |
| 線條粗細 | 由版面實作決定，建議 0.5pt ~ 1pt |
| 實作位置 | LabelRenderer |

---

## 6. 資料格式處理規則

以下規則沿用 raw_spec.md §3.3：

| CodeSoft 欄位 | 適用規則                                              | 變更狀態 |
|---------------|-------------------------------------------------------|----------|
| CSNUMBER      | 固定值 "17008"，直接輸出                               | 沿用 |
| CSQTY         | 顯示值加入千分位（如 `6,733`）                         | 沿用 |
| 其他 Text 欄位| Trim 前後空白，保持原值                                | 沿用 |

### 6.1 空值處理（Text 欄位）

| 項目 | 規則 |
|------|------|
| 處理方式 | Text 欄位為空時顯示空字串 |
| 版面影響 | **保留版面位置**，不跳過、不收合 |
| 適用範圍 | 所有 Text 欄位（CSCUSTPO、CSNUMBER、ERPPARTNO、CSCUSTITEMNO、CSQTY、CSREMARK） |

---

## 7. 標籤實體尺寸

| 項目     | 原規格（raw_spec.md §5.2）| 本次修正       |
|----------|--------------------------|----------------|
| 標籤寬度 | 100mm                    | 100mm（不變）  |
| 標籤高度 | 60mm                     | 60mm（不變）   |

> 📌 QW075551-2 物料標籤維持原規格尺寸 100mm × 60mm，與 QW075551-1 出貨標籤（100mm × 80mm）不同。

---

## 8. 驗收 Checklist

以下為本次 Delta Spec 的驗收項目，**以 PDF 輸出為唯一驗收依據**：

| # | 項目 | 驗證方式 | 預期結果 |
|---|------|----------|----------|
| 1 | 標籤尺寸 | PDF 頁面尺寸檢查 | 100mm × 60mm |
| 2 | 標題文字 | 目視檢查 | 「物料標籤」（置中） |
| 3 | 版面佈局 | 目視檢查 | 左右兩欄式佈局 |
| 4 | 欄位雙行顯示 | 目視檢查 | 小字行（標籤:值）+ 大字行（純值 Bold） |
| 5 | ERPPARTNO 顯示 | 目視檢查 | 純文字（非條碼） |
| 6 | QR Code | 目視檢查 | 無 QR Code |
| 7 | Code 128 | 目視檢查 | 無 Code 128 條碼 |
| 8 | CSNUMBER 顯示值 | 目視檢查 | 固定值 "17008" |
| 9 | CSQTY 顯示值 | 目視檢查 | 有千分位（如 6,733） |
| 10 | 標籤邊框 | 目視檢查 | 有外框，無分隔線 |
| 11 | 欄位前綴標籤 | 目視檢查 | 單號: / 代碼: / ERP料號: / 規格型號: / 數量: / D/C (LOT NO. ): |
| 12 | 長文字處理 | 以超長測試資料驗證 | 縮小字體，不截斷 |

---

## 附錄 A：欄位對照速查表

以下為 QW075551-2 完整欄位對照的最終版本：

| Item | CodeSoft 欄位    | 資料來源         | Type    | 顯示前綴標籤 | 備註 |
|------|------------------|------------------|---------|--------------|------|
| 1    | CSCUSTPO         | cscustpo         | Text    | 單號: | |
| 2    | CSNUMBER         | "17008"          | Text    | 代碼: | 固定值 |
| 3    | ERPPARTNO        | erpmat           | Text    | ERP料號: | ⚠️ 原為 Barcode |
| 4    | CSCUSTITEMNO     | nvr_cust_item_no | Text    | 規格型號: | |
| 5    | CSQTY            | ogd09            | Text    | 數量: | 顯示值含千分位 |
| 6    | CSREMARK         | nvr_remark10     | Text    | D/C (LOT NO. ): | |

### 顯示格式說明

每個欄位採用 **雙行顯示**：

| 行別 | 字型 | 格式 | 範例 |
|------|------|------|------|
| 小字行 | 8pt | 標籤:實際值 | 單號:P600-X172509050001 |
| 大字行 | 11pt Bold | 純實際值 | P600-X172509050001 |

- 本標籤無 QR Code 與 Barcode，所有欄位均為純文字
