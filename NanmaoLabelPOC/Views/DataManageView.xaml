<UserControl x:Class="NanmaoLabelPOC.Views.DataManageView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="1200"
             Background="#F5F5F5">

    <!--
    è³‡æ–™ç®¡ç†åˆ†é 
    [ref: raw_spec 8.5]

    ä½ˆå±€ï¼š
    - Row 0: å·¥å…·åˆ— (60px)
    - Row 1: DataGrid (60*)
    - Row 2: æ¬„ä½ç·¨è¼¯å€ (40*)
    -->

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <!-- å·¥å…·åˆ— 60px [ref: raw_spec 8.5] -->
            <RowDefinition Height="60"/>
            <!-- DataGrid 60* [ref: raw_spec 8.5] -->
            <RowDefinition Height="60*"/>
            <!-- æ¬„ä½ç·¨è¼¯å€ 40* [ref: raw_spec 8.5] -->
            <RowDefinition Height="40*"/>
        </Grid.RowDefinitions>

        <!-- å·¥å…·åˆ— [ref: raw_spec 8.5, 8.6] -->
        <!-- T010-T012: ä½ç½®åˆ†å€ä½ˆå±€ï¼ˆå»ºç«‹å€ | å±éšªå€ | ç¢ºèªå€ï¼‰[ref: spec.md FR-001~FR-004] -->
        <Border Grid.Row="0"
                Background="White"
                BorderBrush="#E0E0E0"
                BorderThickness="1"
                CornerRadius="4"
                Margin="0,0,0,8">
            <Grid VerticalAlignment="Center" Margin="8,0">
                <Grid.ColumnDefinitions>
                    <!-- å»ºç«‹å€ï¼ˆå·¦å´ï¼‰[FR-001, FR-002] -->
                    <ColumnDefinition Width="Auto"/>
                    <!-- å½ˆæ€§ç©ºé–“ -->
                    <ColumnDefinition Width="*"/>
                    <!-- å±éšªå€ï¼ˆä¸­é–“ï¼‰[FR-001, FR-003] -->
                    <ColumnDefinition Width="Auto"/>
                    <!-- å½ˆæ€§ç©ºé–“ -->
                    <ColumnDefinition Width="*"/>
                    <!-- ç¢ºèªå€ï¼ˆå³å´ï¼‰[FR-001, FR-004] -->
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- ============================================================ -->
                <!-- å»ºç«‹å€ï¼ˆå·¦å´ï¼‰ï¼šåŒ¯å…¥ã€æ–°å¢ž [FR-001, FR-002]                   -->
                <!-- å»ºç«‹å€å…§æŒ‰éˆ•é–“è· 8px [FR-002]                                 -->
                <!-- T015: å¥—ç”¨ ActionButtonStyle                                  -->
                <!-- ============================================================ -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <!-- åŒ¯å…¥æŒ‰éˆ• -->
                    <Button x:Name="ImportButton"
                            Style="{StaticResource ActionButtonStyle}"
                            MinWidth="110" MinHeight="45"
                            Height="45"
                            FontSize="14"
                            FontFamily="Microsoft JhengHei"
                            Click="ImportButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ“¥ " FontSize="18" VerticalAlignment="Center"/>
                            <TextBlock Text="åŒ¯å…¥" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <!-- æ–°å¢žæŒ‰éˆ•ï¼ˆé–“è· 8pxï¼‰[FR-002] -->
                    <Button x:Name="AddButton"
                            Style="{StaticResource ActionButtonStyle}"
                            Command="{Binding AddRecordCommand}"
                            MinWidth="110" MinHeight="45"
                            Height="45"
                            Margin="8,0,0,0"
                            FontSize="14"
                            FontFamily="Microsoft JhengHei">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="âž• " FontSize="18" VerticalAlignment="Center"/>
                            <TextBlock Text="æ–°å¢ž" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- ============================================================ -->
                <!-- å±éšªå€ï¼ˆä¸­é–“ï¼‰ï¼šåˆªé™¤ [FR-001, FR-003]                         -->
                <!-- èˆ‡ç›¸é„°å€åŸŸé–“è· â‰¥32px [FR-003]                                 -->
                <!-- T015: å¥—ç”¨ ActionButtonStyle                                  -->
                <!-- ============================================================ -->
                <Button Grid.Column="2"
                        x:Name="DeleteButton"
                        Style="{StaticResource ActionButtonStyle}"
                        MinWidth="110" MinHeight="45"
                        Height="45"
                        Margin="32,0"
                        FontSize="14"
                        FontFamily="Microsoft JhengHei"
                        IsEnabled="{Binding HasSelectedRecord}"
                        Click="DeleteButton_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ—‘ï¸ " FontSize="18" VerticalAlignment="Center"/>
                        <TextBlock Text="åˆªé™¤" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <!-- ============================================================ -->
                <!-- ç¢ºèªå€ï¼ˆå³å´ï¼‰ï¼šå„²å­˜ [FR-001, FR-004]                         -->
                <!-- T015: å¥—ç”¨ ActionButtonStyle                                  -->
                <!-- T035: å¥—ç”¨ PulseActionButtonStyleï¼ˆè„ˆå‹•æ•ˆæžœï¼‰                 -->
                <!-- FR-016: IsDirty=True æ™‚å„²å­˜æŒ‰éˆ•è„ˆå‹•å…‰æšˆ                       -->
                <!-- ============================================================ -->
                <Button Grid.Column="4"
                        x:Name="SaveButton"
                        Style="{StaticResource PulseActionButtonStyle}"
                        MinWidth="110" MinHeight="45"
                        Height="45"
                        FontSize="14"
                        FontFamily="Microsoft JhengHei"
                        IsEnabled="{Binding IsDirty}"
                        Click="SaveButton_Click">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ’¾ " FontSize="18" VerticalAlignment="Center"/>
                        <TextBlock Text="å„²å­˜" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Border>

        <!-- DataGrid [ref: raw_spec 8.5] -->
        <Border Grid.Row="1"
                Background="White"
                BorderBrush="#E0E0E0"
                BorderThickness="1"
                CornerRadius="4"
                Margin="0,0,0,8">
            <!-- T061: DataGrid è¡Œé«˜ min 40px, æŒ‰éˆ•é–“è· 4px -->
            <DataGrid x:Name="RecordDataGrid"
                      ItemsSource="{Binding Records}"
                      SelectedItem="{Binding SelectedRecord, Mode=TwoWay}"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      SelectionMode="Single"
                      SelectionUnit="FullRow"
                      GridLinesVisibility="Horizontal"
                      HeadersVisibility="Column"
                      Background="White"
                      BorderThickness="0"
                      FontFamily="Microsoft JhengHei"
                      FontSize="16"
                      RowHeight="40"
                      MinRowHeight="40"
                      IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="å–®æ“šç·¨è™Ÿ" Binding="{Binding Ogb19}" Width="120"/>
                    <DataGridTextColumn Header="å®¢æˆ¶åç¨±" Binding="{Binding NvrCust}" Width="150"/>
                    <DataGridTextColumn Header="å®¢æˆ¶æ–™è™Ÿ" Binding="{Binding NvrCustItemNo}" Width="130"/>
                    <DataGridTextColumn Header="æ—¥æœŸ" Binding="{Binding Obe25}" Width="100"/>
                    <DataGridTextColumn Header="æ•¸é‡" Binding="{Binding Ogd09}" Width="80"/>
                    <DataGridTextColumn Header="è£½ä»¤å–®è™Ÿ" Binding="{Binding Pono}" Width="130"/>
                    <DataGridTextColumn Header="è£ç½®ç·¨è™Ÿ" Binding="{Binding Ima902}" Width="130"/>
                </DataGrid.Columns>
                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#F0F0F0"/>
                        <Setter Property="Padding" Value="8,4"/>
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="BorderThickness" Value="0,0,1,1"/>
                        <Setter Property="BorderBrush" Value="#E0E0E0"/>
                    </Style>
                </DataGrid.ColumnHeaderStyle>
                <!-- T015/T016: å¥—ç”¨å…±ç”¨ DataGridRowStyle [US1] -->
                <DataGrid.RowStyle>
                    <StaticResource ResourceKey="DataGridRowStyle"/>
                </DataGrid.RowStyle>
                <!-- T017: å¥—ç”¨ DataGridCellStyle ç¢ºä¿ Cell é€æ˜Žä¸è¦†è“‹ Row å…‰æ¢ [US1] -->
                <DataGrid.CellStyle>
                    <StaticResource ResourceKey="DataGridCellStyle"/>
                </DataGrid.CellStyle>
            </DataGrid>
        </Border>

        <!-- æ¬„ä½ç·¨è¼¯å€ [ref: raw_spec 8.5, 8.6] -->
        <!-- T061: è¼¸å…¥æ¬„ä½ min 30px, recommended 36px -->
        <Border Grid.Row="2"
                Background="White"
                BorderBrush="#E0E0E0"
                BorderThickness="1"
                CornerRadius="4">
            <Grid Margin="16"
                  Visibility="{Binding HasSelectedRecord, Converter={StaticResource BoolToVisibilityConverter}}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- å·¦å´æ¬„ä½ [T055: é›™å‘ç¶å®š] -->
                <StackPanel Grid.Column="0">
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="å–®æ“šç·¨è™Ÿ:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.Ogb19, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="å®¢æˆ¶åç¨±:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.NvrCust, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="å®¢æˆ¶æ–™è™Ÿ:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.NvrCustItemNo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="å®¢æˆ¶ P/N:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.NvrCustPn, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="æ—¥æœŸ:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.Obe25, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="æ•¸é‡:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox x:Name="QuantityTextBox" Grid.Column="1" Text="{Binding SelectedRecord.Ogd09, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="QuantityField_TextChanged"/>
                    </Grid>
                </StackPanel>

                <!-- å³å´æ¬„ä½ [T055: é›™å‘ç¶å®š] -->
                <StackPanel Grid.Column="2">
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="è£½ä»¤å–®è™Ÿ:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.Pono, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="è£ç½®ç·¨è™Ÿ:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.Ima902, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="å‚™è¨»:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.NvrRemark10, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="ERP æ–™è™Ÿ:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.Erpmat, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                    <Grid Margin="0,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="å®¢æˆ¶æŽ¡è³¼å–®:" VerticalAlignment="Center" FontWeight="Bold" FontSize="13" FontFamily="Microsoft JhengHei"/>
                        <TextBox Grid.Column="1" Text="{Binding SelectedRecord.Cscustpo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinHeight="36" Height="36" FontSize="13" FontFamily="Microsoft JhengHei" Padding="8,4" VerticalContentAlignment="Center" TextChanged="EditField_TextChanged"/>
                    </Grid>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
